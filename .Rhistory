library(shiny)
library(xlsx)
library(minerva) #なんだっけ
#library(rpart) #forest
#library(rpart.plot)
library(randomForest)
data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
dat <- data1
model = randomForest(total ~ .,data = dat)
model = randomForest(total ~ .,data = dat)
dat <- data1
na.action = na.fpass
na.action = na.pass
model = randomForest(total ~ .,data = dat)
model = randomForest(total ~ .,data = dat)
model = randomForest(total ~ .,data = dat, na.action = na.pass)
na.exclude(dat)
model = randomForest(total ~ .,data = dat,)
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
#na.action = na.pass
library(shiny)
library(xlsx)
library(minerva) #なんだっけ
#library(rpart) #forest
#library(rpart.plot)
library(randomForest)
data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
dat <- data1
na.exclude(dat)
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
model
#library(rpart) #forest
#library(rpart.plot)
library(randomForest)
data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
dat <- data1
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
#na.action = na.pass
model
data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
model
sapply(data1 , class)
names(data1)
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
model
importance(model)
data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
model
prediction = predict(model, data2)
data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
model = randomForest(total ~ .,data = dat, na.action = na.roughfix)
model
prediction = predict(model, data2)
prediction
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number2",encoding="UTF-8")
names(data3)
model = randomForest(total ~ .,data = data3[, -1:-17], na.action = na.roughfix)
data4 <- data3[-2,]
head(data4)
#data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
#data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number2",encoding="UTF-8")
data4 <- data3[-1,]
head(data4)
data5 <- data4[,18:22]
model = randomForest(total ~ .,data = data5, na.action = na.roughfix)
names(data5)
head(data5)
sapply(data5 , class)
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number2",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[,18:22]
model = randomForest(total ~ .,data = data5, na.action = na.roughfix)
head(data5)
sapply(data5)
sapply(data5, class)
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number2",encoding="UTF-8")
sapply(data5 , class)
data4 <- data3[-1,]
data5 <- data4[,18:22]
sapply(data5 , class)
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number2",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[,18:22]
sapply(data5 , class)
mode(data5.total) <- "character"
mode(data5."total") <- "numeric"
mode(data5.total) <- "numeric"
mode(data5) <- "numeric"
transform(data, total = as.numeric(total))
sapply(data5 , class)
transform(data5, total = as.numeric(total))
sapply(data5 , class)
data6 <- transform(data5, total = as.numeric(total))
sapply(data6 , class)
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
model
data5 <- data4[c(18,20,21,22,24)]
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"),
weekid = as.numeric(weekid))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
data4 <- data3[-1,]
data5 <- data4[c(18,20,21,22,24)]
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"),
weekid = as.numeric(weekid))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
head(data4)
head(data5)
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
#data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
#data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[c(18,20,21,22,24)]
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"),
weekid = as.numeric(weekid))
head(data6)
sapply(data6, class)
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
model = randomForest(total ~ .,data = data6, na.action = na.roughfix)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 300)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 100)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 5)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 200)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 10)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 100)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 100 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 200 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 300 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 4, ntree = 50 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3, ntree = 50 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 2, ntree = 50 ,num.trees = 50)
model
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3, ntree = 50 ,num.trees = 50)
model
sample.tune <- tuneRF(data6[,2],data6[,5],doBest=T)
data6
#data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
#data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[c(18,20,21,22,19)]
data6 <- transform(data5, total = as.numeric(total),
"曜日" = as.factor("曜日"),
weekid = as.numeric(weekid))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3, ntree = 50 ,num.trees = 50)
model
data6
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日))
sample.tune <- tuneRF(data6[,2],data6[,5],doBest=T)
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3, ntree = 50 ,num.trees = 50)
model
prediction = predict(model, data2)
prediction
#data1 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="train3",encoding="UTF-8")
#data2 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="test3",encoding="UTF-8")
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[c(18,20,21,22,19)]
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3, ntree = 50 ,num.trees = 50)
model
head(data6)
sample.tune <- tuneRF(data6[,2],data6[,5],doBest=T)
data6
tuneRF(data6[,2],data6[,5],plot = TRUE, doBest = TRUE)
tuneRF(data6 %>% select(-y),data6$y,plot = TRUE, doBest = TRUE)
tuneRF(data6$-y,data6$y,plot = TRUE, doBest = TRUE)
tuneRF(data6$(-y),data6$y,plot = TRUE, doBest = TRUE)
tuneRF(data6$祝日,data6$曜日,plot = TRUE, doBest = TRUE)
tuneRF(data6[,-1],data6[4],plot = TRUE, doBest = TRUE)
data6[,4]
tuneRF(data6[,-1],data6[,4],plot = TRUE, doBest = TRUE)
tuneRF(data6[,-1],data6[,4],plot = TRUE, doBest = TRUE, na.action = na.roughfix)
tuneRF(data6[,-1],data6[,5],plot = TRUE, doBest = TRUE, na.action = na.roughfix)
tuneRF(data6[,2:5],data6[,1],plot = TRUE, doBest = TRUE, na.action = na.roughfix)
data5 <- data4[c(18,20,21,22,19)]
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model)
library(xlsx)
library(randomForest)
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- data4[c(18,19,20,21,22)]
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
data5 <- data4[c(18,24,20,21,22)]
data6 <- transform(data5, total = as.numeric(total),
曜日 = as.factor(曜日))
data6 <- transform(data5, total = as.numeric(total),
#曜日 = as.factor(曜日))
weekid = as.numeric(weekid))
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
data5 <- transform(data4, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
data4 <- data3[-1,]
data5 <- transform(data4, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
data6 <- data5[c(18:22)]
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- transform(data4, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
data6 <- data5[c(18:22)]
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data4 <- data3[-1,]
data5 <- transform(data4, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data6 <- data5[c(18:22)]
data6 <- data5[c(18,20,21,22,24)] #weekid_ver
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
head(data6)
library(xlsx)
library(randomForest)
#data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data1 <- read.xlsx("C:/Users/81083/ドキュメント/技術課題選考フォーマット201015.xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
#data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data1 <- read.xlsx("C:/Users/81083/ドキュメント/技術課題選考フォーマット201015.xlsx", password = NULL, sheetName="data",encoding="UTF-8")
#data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data1 <- read.xlsx("C:/Users/81083/Documents/技術課題選考フォーマット201015.xlsx", password = NULL, sheetName="data",encoding="UTF-8")
#data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data1 <- read.xlsx("C:/Users/81083/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
#data3 <- read.xlsx("C:/Program Files/R/R-4.0.3/library/shiny/examples/App-7/senkou_data.xlsx", password = NULL, sheetName="number3",encoding="UTF-8")
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data6 <- data5[c(18:22)]
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
library(xlsx)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data4 <- data5[c(18:22)] #曜日_ver
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
step_mra_fun <- function(dat,fn){
colnames(data1)[1] <- "y"
ans <- lm(dat$y~., data=dat)
ans <- step(ans)
s.ans <- summary(ans)
coe <- s.ans$coefficient
N <- nrow(dat)
aic <- AIC(ans)
conf <- confint(ans,levels=(0.95))
R2 <- summary(ans)$r.squared
result <- cbind(coe,conf,R2,aic,N)
colnames(result)[5:6] <- c("RR95%CI.low”,”RR95%CI.up")
e2 <- deviance(ans)
MSE <- e2 / N
if(nrow(result)>=2){
result[2:nrow(result),7:9] <- ""
}
write.table(cbind("E2",e2,"MSE",MSE),fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
write.table(matrix(c("",colnames(result)),nrow=1),fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
write.table(result,fn,append=T,quote=F,sep=",",row.names=T,col.names=F)
write.table("",fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
}
fn = "ステップワイズsample3.csv" #出力ファイル名
step_mra_fun(dat,fn) #ステップワイズ関数の実行
dat <- data4
step_mra_fun <- function(dat,fn){
colnames(dat)[1] <- "y"
ans <- lm(dat$y~., data=dat)
ans <- step(ans)
s.ans <- summary(ans)
coe <- s.ans$coefficient
N <- nrow(dat)
aic <- AIC(ans)
conf <- confint(ans,levels=(0.95))
R2 <- summary(ans)$r.squared
result <- cbind(coe,conf,R2,aic,N)
colnames(result)[5:6] <- c("RR95%CI.low”,”RR95%CI.up")
e2 <- deviance(ans)
MSE <- e2 / N
if(nrow(result)>=2){
result[2:nrow(result),7:9] <- ""
}
write.table(cbind("E2",e2,"MSE",MSE),fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
write.table(matrix(c("",colnames(result)),nrow=1),fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
write.table(result,fn,append=T,quote=F,sep=",",row.names=T,col.names=F)
write.table("",fn,append=T,quote=F,sep=",",row.names=F,col.names=F)
}
fn = "ステップワイズsample3.csv" #出力ファイル名
step_mra_fun(dat,fn) #ステップワイズ関数の実行
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data4 <- data5[c(18:22)] #曜日_ver
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
model = randomForest(total ~ .,data = data6, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
#prediction = predict(model, data2)
#prediction = predict(model, data2)
#prediction
#prediction = predict(model, data2)
#prediction
#prediction = predict(model, data2)
#prediction
library(xlsx)
library(randomForest)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data4 <- data5[c(18:22)] #曜日_ver
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
dat  <- data4
model = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
test1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="test",encoding="UTF-8")
test2 <- test1[c(18,19,20,21,23)]
tes   <- test2
prediction = predict(model, test)
prediction = predict(model, tes)
prediction
test1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="test",encoding="UTF-8")
test2 <- test1[c(19,20,21,23)]
tes   <- test2
prediction = predict(model, tes)
prediction
test1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="test",encoding="UTF-8")
#test2 <- test1[c(19,20,21,23)]
tes   <- test1
prediction = predict(model, tes)
prediction
library(xlsx)
library(randomForest)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data4 <- data5[c(18:22)] #曜日_ver
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
dat  <- data4
model = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
test1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="test",encoding="UTF-8")
#test2 <- test1[c(19,20,21,23)]
tes   <- test1
prediction = predict(model, tes)
prediction
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
sapply(data1,class)
library(xlsx)
library(randomForest)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
data2 <- data1[,-6]
dat  <- data2
model = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
sapply(dat, cla)
sapply(dat, class)
library(xlsx)
library(randomForest)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
data2 <- data1[,-6]
dat  <- data2
model = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
varImpPlot(model) #影響度を図示
head(dat)
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model2
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
data2 <- data1[,-6]
data2 <- data2[,-6]
dat  <- data2
head(dat)
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
data2 <- data1[,-6]
data3 <- transform(data2, timeid = as.factor(timeid),
曜日 = as.factor(曜日))
dat  <- data3
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model2
varImpPlot(model) #影響度を図示
varImpPlot(model2) #影響度を図示
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2) #ntree = 50 ,num.trees = 50)
model2
varImpPlot(model2) #影響度を図示
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 4) #ntree = 50 ,num.trees = 50)
model2
varImpPlot(model2) #影響度を図示
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model2
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,num.trees = 50) #ntree = 50
model3
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 100 ,num.trees = 100)
model3
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 300 ,num.trees = 300)
model3
varImpPlot(model2)
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 1000 ,num.trees = 1000)
model3
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 700 ,num.trees = 700)
model3
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data",encoding="UTF-8")
data2 <- data1[-1,]
data3 <- transform(data2, total = as.numeric(total),
曜日 = as.factor(曜日),
weekid = as.numeric(weekid))
#data4 <- data5[c(18:22)] #曜日_ver
data4 <- data3[c(18,19,20,21,23)] #weekid_ver
dat  <- data4
model = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3) #ntree = 50 ,num.trees = 50)
model
varImpPlot(model) #影響度を図示
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 500 ,num.trees = 500)
model3
library(xlsx)
library(randomForest)
data1 <- read.xlsx("C:/Users/81803/Documents/技術課題選考フォーマット201015 .xlsx", password = NULL, sheetName="data2",encoding="UTF-8")
data2 <- data1[,-6]
data3 <- transform(data2, timeid = as.factor(timeid),
曜日 = as.factor(曜日))
dat  <- data3
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,ntree = 500 ,num.trees = 500)
model3
varImpPlot(model2)
model3 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,num.trees = 500)
model3
varImpPlot(model2)
model4 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,num.trees = 500)
model4
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 3 ,num.trees = 400)
model2
varImpPlot(model2)
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2 ,num.trees = 400)
model2
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2 ,ntree = 700)
model2
varImpPlot(model2)
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2 ,ntree = 300)
model2
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2 ,ntree = 100)
model2
varImpPlot(model2)
model2 = randomForest(total ~ .,data = dat, na.action = na.roughfix, mtry = 2 ,ntree = 500)
model2
varImpPlot(model2)
